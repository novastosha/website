<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="author" content="S. S.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="my homepage!">
    <link rel="stylesheet" href="https://cdn.sajed.dev/web/assets/styles.css">
    <title>sajed.dev</title>
    <script>
        const destMap = {
            // "name": ["display name", "encoded URL", display in body]
            "default": ['bXkgaG9tZXBhZ2U=', 'aHR0cHM6Ly9zYWplZC5kZXY=', true],
            "pintrest": ['bXkgcGludHJlc3Q=', 'aHR0cHM6Ly91ay5waW50ZXJlc3QuY29tL3NsaW1hbmlfc2FqZWQv', true],
            "music": ['bXkgZmF2IG11c2lj', 'aHR0cHM6Ly9zYWplZC5kZXYvbXVzaWM=', true],
        };

        function getParams() {
            const params = {};
            const queryString = window.location.search.slice(1);
            for (const pair of queryString.split('&')) {
                if (!pair) continue;
                const [key, value] = pair.split('=').map(decodeURIComponent);
                params[key] = value;
            }
            return params;
        }

        function getDestUrl() {
            const params = getParams();
            const destKey = params.dest || params.to || params.d || "none";
            return destMap[destKey] || (destKey == "none" ? undefined : destMap["default"]);
        }

        function performRedirect() {
            const destUrl = getDestUrl();
            if (!destUrl) return; // Display all possible destinations in the body if no destination is set.
            console.log("Redirecting to:", destUrl);

            const url = atob(destUrl[1]);
            window.location.href = url;
        }

        window.onload = performRedirect;

        document.addEventListener("DOMContentLoaded", function() {
            const link = document.getElementById("manual-redirect-link");
            const dUrl = getDestUrl();
            if (link && dUrl) {
                link.href = atob(dUrl[1]);
            }

            if (!dUrl) {
                document.getElementById("redirect-message").remove();

                const contentDiv = document.getElementById("content");
                contentDiv.style.display = "block";
                const ul = document.getElementById("possible-destinations");
                for (const key in destMap) {
                    if (destMap.hasOwnProperty(key)) {
                        const li = document.createElement("li");
                        
                        const displayName = atob(destMap[key][0]);
                        const encodedUrl = atob(destMap[key][1]);
                        const shouldDisplay = destMap[key][2];
                        if (!shouldDisplay) continue;
                        li.innerHTML = `<b>${displayName}:</b> <a href="${encodedUrl}">${encodedUrl}</a>`;
                        li.style.display = "list-item";
                    
                        ul.appendChild(li);
                    }
                }
            }
        });
    </script>
</head>

<body>
    <p id="redirect-message">Redirecting... If you are not redirected, please enable Javascript in your browser settings or try <a id="manual-redirect-link" href="#">clicking here</a></p>

    <div id="content" style="display:none;">
        <h1>my other links: </h1>
        <ul id="possible-destinations"></ul>
    </div>
</body>
</html>